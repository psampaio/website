---
import type {Entry} from "@keystatic/core/reader"
import keystaticConfig from "../../keystatic.config";
import {reader} from "../reader";

type OwnerInfoProps = Entry<(typeof keystaticConfig)['singletons']['ownerInfo']>
const ownerInfo = await reader.singletons.ownerInfo.read();
const {name, headline, description, small_image} = ownerInfo as OwnerInfoProps;

import Header from "@components/Header.astro";
import "@fontsource/be-vietnam-pro";
import "@fontsource-variable/gabarito";
import {SITE_CONFIG} from "@config";
import Footer from "@components/Footer.astro";
import Plausible from "@components/Plausible.astro";

const {
    title= `${name} - ${headline}`,
    navLinks,
    lang,
    socialLinks,
    socialImage,
    canonicalURL = new URL(Astro.url.pathname, Astro.site).href,
    plausibleDomain
} = SITE_CONFIG;

const ogImgUrl = canonicalURL + socialImage;
---

<!doctype html>
<html lang={lang} class="scroll-pt-16 scroll-smooth">
<head>
    <meta charset="UTF-8"/>
    <meta name="description" content={description}/>
    <meta name="author" content={name}/>
    <meta name="viewport" content="width=device-width"/>
    <link rel="icon" type="image/png" href="/favicon.png"/>
    <meta name="generator" content={Astro.generator}/>
    <title>{title}</title>

    <meta property="og:title" content={title}/>
    <meta property="og:description" content={description}/>
    <meta property="og:url" content={canonicalURL}/>
    <meta property="og:image" content={ogImgUrl}/>

    <meta property="twitter:card" content="summary_large_image"/>
    <meta property="twitter:url" content={canonicalURL}/>
    <meta property="twitter:title" content={title}/>
    <meta property="twitter:description" content={description}/>
    <meta property="twitter:image" content={ogImgUrl}/>
    <Plausible plausibleDomain={plausibleDomain}/>
</head>
<body class="bg-black font-sans">
<Header siteLogo={small_image} navLinks={navLinks}/>
<main class="mx-auto max-w-3xl px-5">
    <slot/>
</main>
<Footer author={name} socialLinks={socialLinks}/>
</body>
</html>
